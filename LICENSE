Credits to T3 stack for basic framework. 